# AI Model Validation - Simplified
name: AI Model Validation

on:
  push:
    branches: [ "main", "copilot/*" ]
    paths:
      - 'st-*.py'
      - 'Qwen110BChat.py'
      - 'variabot_*.py'
  pull_request:
    branches: [ "main" ]
    paths:
      - 'st-*.py'
      - 'Qwen110BChat.py'
      - 'variabot_*.py'

permissions:
  contents: read

jobs:
  streamlit-validation:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      
    - name: Set up Python 3.11
      uses: actions/setup-python@v4
      with:
        python-version: "3.11"
        
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        
    - name: Validate Streamlit App Syntax
      run: |
        echo "ðŸ” Validating Streamlit application syntax..."
        for file in st-*.py; do
          if [ -f "$file" ]; then
            echo "ðŸ“„ Checking $file..."
            python -m py_compile "$file"
            echo "âœ… $file syntax valid"
          fi
        done
        
    - name: Test Gradio Client Integration
      run: |
        echo "ðŸ¤– Testing Gradio client integration..."
        python -c "from gradio_client import Client; print('âœ… Gradio client imported successfully')"
        
    - name: Validate Model Configurations
      run: |
        echo "âš™ï¸ Validating AI model configurations..."
        python -c "import os; model_files = [f for f in os.listdir('.') if f.startswith('st-') and f.endswith('.py')]; print(f'Found {len(model_files)} model files')"
        
    - name: Test Chat Interface Components
      run: |
        echo "ðŸ’¬ Testing chat interface components..."
        if [ -f "Qwen110BChat.py" ]; then
          python -m py_compile Qwen110BChat.py
          echo "âœ… Qwen110BChat.py syntax valid"
        fi
        
    - name: Test Main Application Entry
      run: |
        echo "ðŸš€ Testing main application entry point..."
        if [ -f "main.py" ]; then
          python -m py_compile main.py
          echo "âœ… main.py syntax valid"
        fi
        
    - name: Streamlit Import Test
      run: |
        echo "ðŸŒŠ Running Streamlit smoke tests..."
        python -c "import streamlit as st; print('âœ… Streamlit imported successfully')"
        
    - name: Generate AI Model Report
      run: |
        echo "ðŸ“Š Generating AI model validation report..."
        echo "AI Model Validation Report" > ai-model-report.txt
        echo "==========================" >> ai-model-report.txt
        echo "Timestamp: $(date)" >> ai-model-report.txt
        echo "Status: All AI model validation tests completed" >> ai-model-report.txt
        
    - name: Upload AI Model Report
      uses: actions/upload-artifact@v3
      with:
        name: ai-model-validation-report
        path: ai-model-report.txt